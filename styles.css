:root {
  --bg: #f7f9fb;
  --card: #ffffff;
  --muted: #6b7280;
  --accent: #0ea5b7;
  --accent-2: #7c3aed;
  --win: #16a34a;
  --lose: #dc2626;
  --card-w: 140px;
  --card-h: var(--card-w);
  --header-h: 40px;
}
.hidden {
  display: none;
}

body {
  font-family:
    system-ui,
    -apple-system,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial;
  background: linear-gradient(180deg, var(--bg), #ffffff);
  color: #0f1724;
  margin: 0;
  padding: calc(16px + var(--header-h)) 16px 16px 16px;
}

#status {
  margin: 12px 0;
  padding: 8px 12px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.6);
  box-shadow: 0 4px 10px rgba(2, 6, 23, 0.02);
}
.app-header #status {
  margin: 0;
  padding: 4px 8px;
  border-radius: 6px;
  background: transparent;
  box-shadow: none;
}

.app-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--header-h);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px;
  background: linear-gradient(180deg, #ffffff, #fbfdff);
  border-bottom: 1px solid rgba(15, 23, 36, 0.16);
  box-shadow: 0 4px 12px rgba(2, 6, 23, 0.04);
  z-index: 40;
}
.app-header h1 {
  font-size: 15px;
  margin: 0;
  font-weight: 700;
}

.char-card,
.card.small {
  width: var(--card-w);
  height: var(--card-h);
  background: var(--card);
  border: 1px solid rgba(15, 23, 36, 0.18);
  box-sizing: border-box;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 8px 18px rgba(16, 24, 40, 0.06);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition:
    transform 180ms ease,
    box-shadow 180ms ease,
    border-color 180ms ease;
}
.char-card .name,
.card.small .name {
  font-weight: 700;
  font-size: 14px;
  margin-bottom: 6px;
}

.card-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: flex-start;
}

.players-row {
  display: flex;
  gap: 18px;
  justify-content: space-between;
  margin-bottom: 12px;
}
.player-panel {
  transition: all 220ms ease;
  padding: 12px;
  border-radius: 10px;
  box-sizing: border-box;
  background: linear-gradient(180deg, #ffffff, #fbfdff);
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(15, 23, 36, 0.08);
}
.player-panel h3 {
  margin: 0 0 8px 0;
  color: #666;
  transition: color 240ms ease, text-shadow 240ms ease;
}
.player-panel .characters {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  align-items: flex-start;
  min-height: calc(var(--card-h) + 12px);
}

/* overlay used to smoothly fade active panel backgrounds without abrupt jumps */
.player-panel::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 10px;
  pointer-events: none;
  background: transparent;
  opacity: 0;
  transition: opacity 320ms ease;
  z-index: 0;
}
/* ensure panel contents sit above the overlay */
.player-panel > * {
  position: relative;
  z-index: 1;
}

.player-panel.active::after {
  opacity: 1;
}

/* player-specific active gradients applied to the overlay so they fade */
#player-1-panel.active::after {
  background: linear-gradient(180deg, #d97706 0%, #92400e 100%);
}
#player-2-panel.active::after {
  background: linear-gradient(180deg, #7fcf7a 0%, #2f855a 100%);
}

@media (min-width: 900px) {
  .player-panel .characters {
    flex-wrap: nowrap;
  }
  .player-panel {
    flex: 0 0 calc(50% - 9px);
  }
}

.player-panel.active {
  transform: translateY(-3px);
  /* background handled via pseudo-element for smooth fade */
  color: #fff;
  border: 1px solid rgba(2, 6, 23, 0.12);
  box-shadow: 0 16px 44px rgba(2, 6, 23, 0.12);
}
.player-panel.active h3,
.player-panel.active h4 {
  color: #fff;
  text-shadow: 0 -1px 1px rgba(0, 0, 0, 0.45);
}
.player-panel.active .char-card,
.player-panel.active .card.small {
  background: var(--card);
  color: #0f1724;
  /* remove border and rely on tight shadows so cards don't rely on edges to separate from vivid panel */
  border: none;
  /* small, tight outer shadow for depth and a subtle light inset so white cards read on colored backgrounds */
  box-shadow: 0 4px 8px rgba(2, 6, 23, 0.12), inset 0 1px 0 rgba(255,255,255,0.6);
  /* (no margin compensation needed when using border-box) */
}

#player-1-panel.active {
  border-color: rgba(194, 65, 12, 0.24);
  box-shadow: 0 18px 48px rgba(194, 65, 12, 0.14);
}
#player-2-panel.active {
  border-color: rgba(47, 133, 90, 0.2);
  box-shadow: 0 18px 48px rgba(47, 133, 90, 0.12);
}

#hand-area {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 8px 0;
}
.turn-controls {
  display: flex;
  gap: 8px;
  /* Positioned in the lower-right corner of the player panel for the active player */
  position: absolute;
  right: 12px;
  bottom: 12px;
  z-index: 2;
}
.turn-controls button {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid rgba(15, 23, 36, 0.06);
  background: var(--accent);
  color: #fff;
  cursor: pointer;
}
.turn-controls button.secondary {
  background: transparent;
  color: var(--muted);
  border: 1px solid rgba(15, 23, 36, 0.06);
}
.play-selected {
  margin-top: 6px;
  /* Keep the button in the flow but hide it visually using opacity and pointer-events.
     JS will toggle the `.visible` class to show it. This avoids relying on `display:none`
     which prevented the script from showing the button via inline-style removal. */
  display: inline-flex;
  align-items: center;
  gap: 8px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(6px);
  transition: opacity 160ms ease, transform 160ms ease;
}
.play-selected.visible {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

.card.small.facedown {
  background: linear-gradient(180deg, var(--card), #f3f4f6);
  border: 1px solid rgba(15, 23, 36, 0.12);
  display: flex;
  align-items: center;
  justify-content: center;
}
.card.small.facedown .back-face {
  width: 100%;
  height: 100%;
  background: repeating-linear-gradient(
    45deg,
    rgba(0, 0, 0, 0.02) 0 6px,
    transparent 6px 12px
  );
  border-radius: 8px;
}

/* Log area removed — use console for logging instead */

#modal:not(.hidden) {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(2, 6, 23, 0.06);
  z-index: 60;
}
#modal-inner {
  background: var(--card);
  padding: 20px;
  border-radius: 10px;
  min-width: 320px;
  border: 1px solid rgba(15, 23, 36, 0.08);
}
#modal-body {
  max-height: 320px;
  overflow: auto;
  margin: 8px 0;
}
#modal-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

#floating-actions {
  position: fixed;
  right: 18px;
  bottom: 18px;
  z-index: 80;
  display: flex;
  gap: 8px;
  align-items: center;
}
#floating-actions button {
  background: transparent;
  border: 1px solid rgba(15, 23, 36, 0.06);
  color: var(--muted);
  padding: 8px 10px;
  border-radius: 8px;
  font-size: 13px;
  cursor: pointer;
}
#floating-actions button:hover {
  color: var(--accent);
  box-shadow: 0 8px 20px rgba(14, 165, 183, 0.04);
}
#floating-actions button:disabled {
  opacity: 0.38;
  cursor: not-allowed;
}

.char-card.selected {
  outline: 2px dashed var(--accent-2);
  background: linear-gradient(180deg, #f8fafc, #f1f5f9);
  border-color: rgba(6, 182, 212, 0.12);
  box-shadow: 0 20px 50px rgba(14, 165, 183, 0.12);
  border: 2px solid rgba(124, 58, 237, 0.18);
}

.char-card {
  transition:
    transform 160ms ease,
    box-shadow 160ms ease,
    border-color 160ms ease,
    border-width 120ms ease;
}
.char-card:hover {
  border-color: rgba(14, 165, 183, 0.18);
  border-width: 1.5px;
}
.char-card.clickable:hover {
  transform: translateY(-6px);
  box-shadow: 0 18px 40px rgba(14, 165, 183, 0.1);
  border-color: rgba(6, 182, 212, 0.18);
}
.char-card:active {
  transform: translateY(-2px) scale(0.995);
}
.hand-area .card.small:not(.clickable):hover,
.hand-area .card.small:not(.clickable):focus,
.hand-area .card.small:not(.clickable):focus-visible,
.hand-area .card.small:not(.clickable):active {
  /* No hover/focus/active effects for non-playable hand cards inside the hand area */
  transform: none !important;
  box-shadow: none !important;
  cursor: default !important;
  filter: none !important;
  /* remove the real border so it can't change size — the visual edge is provided by the inset shadow */
  border: none !important;
  transition: none !important; /* prevent any transitions from animating */
  outline: none !important;
}
.card.small.clickable:hover {
  box-shadow: 0 10px 26px rgba(14, 165, 183, 0.1);
  transform: translateY(-4px);
}
.char-card.clickable.selected {
  box-shadow: 0 18px 40px rgba(14, 165, 183, 0.14);
  transform: translateY(-6px);
  border-color: rgba(124, 58, 237, 0.18);
}
.card.small.clickable.selected {
  /* Match the hover lift and elevation but use a purple outer ring instead of blue.
     This mirrors `.card.small.clickable:hover` but replaces the second shadow color. */
  transform: translateY(-4px);
  box-shadow: 0 10px 26px rgba(14, 165, 183, 0.1), 0 0 0 2px rgba(124, 58, 237, 0.9);
  border-color: rgba(124, 58, 237, 0.5) !important;
}

/* Visual highlight for a newly stolen card. Applied transiently for ~250ms. */
.card.small.stolen {
  transform: translateY(-6px);
  /* Use an outer box-shadow to emulate a 2px bright yellow ring without affecting layout.
     Keep border-width unchanged to avoid layout shift; box-shadow provides the visible rim. */
  box-shadow: 0 18px 40px rgba(250, 204, 21, 0.14), 0 0 0 2px rgba(250, 204, 21, 1);
  /* Keep border color slightly warm so the edge reads on different backgrounds. */
  border-color: rgba(250, 204, 21, 0.6) !important;
  transition: box-shadow 200ms ease, transform 200ms ease;
}

/* When a selected small card is hovered/focused/active, keep the selected purple
   styling and use the default cursor — do not let the general clickable:hover rule
   switch the ring to blue or change the cursor to pointer. */
.card.small.clickable.selected:hover,
.card.small.clickable.selected:focus,
.card.small.clickable.selected:focus-visible,
.card.small.clickable.selected:active {
  cursor: default !important;
  transform: translateY(-4px) !important;
  box-shadow: 0 10px 26px rgba(14, 165, 183, 0.1), 0 0 0 2px rgba(124, 58, 237, 0.9) !important;
  border-color: rgba(124, 58, 237, 0.5) !important;
}
.hand-area .card.small:not(.clickable):not(.selected) {
  opacity: 0.8 !important; /* visually de-emphasize non-playable hand cards */
  cursor: default !important;
}

/* By default, character cards inside player panels should not have hover effects
   (e.g., during draft the player's panels show picks but they aren't interactive).
   Only allow hover if the card has an explicit .clickable class. */
.player-panel .char-card:hover {
  transform: none !important;
  box-shadow: none !important;
  /* restore the neutral border color without visual emphasis */
  border-color: rgba(15, 23, 36, 0.18) !important;
}

.player-panel .char-card.clickable:hover {
  /* re-enable the clickable hover treatment for actionable characters */
  transform: translateY(-6px) !important;
  box-shadow: 0 18px 40px rgba(14, 165, 183, 0.1) !important;
  border-color: rgba(6, 182, 212, 0.18) !important;
}

.clickable {
  cursor: pointer;
}
.char-card.clickable,
.card.small.clickable {
  transition:
    transform 160ms ease,
    box-shadow 160ms ease,
    border-color 160ms ease;
  /* Keep border width static to avoid layout shift; hover ring is done with box-shadow */
}
.char-card.clickable:hover,
.card.small.clickable:hover {
  transform: translateY(-4px);
  /* primary elevation shadow plus a blue ring to indicate actionability without changing layout */
  box-shadow: 0 10px 26px rgba(14, 165, 183, 0.1),
    0 0 0 2px rgba(59, 130, 246, 0.9);
  border-color: rgba(59, 130, 246, 0.5);
}

body.target-mode .char-card.clickable:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(14, 165, 183, 0.12);
  cursor: pointer;
  /* Match the actionable hover treatment in normal mode using a shadow ring so layout doesn't shift */
  box-shadow: 0 12px 30px rgba(14, 165, 183, 0.12), 0 0 0 2px rgba(59, 130, 246, 0.9);
  border-color: rgba(59,130,246,0.5);
}
body.target-mode .char-card.selected:hover {
  transform: translateY(-6px);
  box-shadow: 0 14px 34px rgba(6, 182, 212, 0.1);
}
body.target-mode .char-card:not(.selected):hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 18px rgba(7, 128, 158, 0.04);
}
body.target-mode .card.small:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 18px rgba(7, 128, 158, 0.06);
}

.hp {
  display: flex;
  flex-direction: column;
  gap: 6px;
  align-items: stretch;
}
.hp-text {
  font-size: 13px;
  color: rgba(27, 37, 51, 0.86);
  text-align: center;
}
.hp-bar {
  height: 12px;
  background: rgba(15, 23, 36, 0.1);
  border-radius: 8px;
  overflow: hidden;
}
.hp-fill {
  height: 100%;
  background: linear-gradient(90deg, #14532d, #0f3d23);
  width: 50%;
  transition: width 240ms ease;
}

.draft-placeholder {
  color: var(--muted);
  padding: 10px;
  border-radius: 8px;
  font-size: 13px;
}
.player-panel.active .draft-placeholder {
  color: #fff;
}

/* Disable hover effects on character cards inside player panels unless explicitly marked clickable.
   This prevents hover/outline/shadow changes on drafted characters shown in each player's panel. */
.player-panel:not(.active) .char-card:not(.clickable):hover {
  /* For inactive player panels keep the neutral border and base shadow on hover */
  transform: none !important;
  box-shadow: 0 8px 18px rgba(16, 24, 40, 0.06) !important;
  border: 1px solid rgba(15, 23, 36, 0.18) !important;
}

.player-panel.active .char-card:not(.clickable):hover {
  /* For active panels (white cards on colored background) keep borderless look on hover */
  transform: none !important;
  box-shadow: 0 4px 8px rgba(2, 6, 23, 0.12) !important;
  border: none !important;
  border-width: 0 !important;
}

/* Re-enable clickable hover for actionable cards inside player panels (higher specificity) */
.player-panel .char-card.clickable:hover {
  transform: translateY(-6px) !important;
  box-shadow: 0 18px 40px rgba(14, 165, 183, 0.1) !important;
  border-color: rgba(6, 182, 212, 0.18) !important;
}

@media (min-width: 900px) {
  /* Layout adjustments for wider screens */
  #hand-area {
    flex: 1;
  }
}
@media (max-width: 899px) {
  .players-row {
    flex-direction: column;
  }
  /* Small-screen layout adjustments */
}
